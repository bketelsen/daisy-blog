---
import Blog from "@layouts/blog";
import Date from "@components/utilities/Date";
import { Img } from "astro-imagetools/components";

import { published } from "@data/post"
import Prose from "@components/prose";

export async function getStaticPaths() {
  const markdownFiles = await Astro.glob('../../content/blog/**/*.md');
  const posts = published(markdownFiles);

  return posts.map((post) => {
    return {
      params: { slug: post.slug },
      props: { post }
    };
  })
}

// Destructure to get both `Astro.props.post` and `Astro.props.post.Content`
const { post: { Content }, post } = Astro.props;
---
<Blog title={post.title} desc={post.desc} img={post.img ? post.img : null}>
  <div class="flex justify-center">
		<div class="py-6 prose lg:prose-lg">
			{post.img && post.imgWidth && post.imgHeight ?
				<figure class="flex justify-center">
					<img src={post.img} alt={post.title} width={post.imgWidth} height={post.imgHeight} class="rounded bg-base-200" />
				</figure>
				: post.img &&
				<figure class="flex justify-center">
					<img src={post.img} alt={post.title} class="rounded bg-base-200" />
				</figure>
			}
			<span class="mb-2 uppercase badge badge-success">Article</span>
			<h1 class="font-title">{post.title}</h1>
			<div class="flex gap-3">
				<span class="badge badge-primary">
					<Date date={post.date}/>
				</span>
			</div>
			<Prose>
				<Content />
			</Prose>
		</div>
	</div>
</Blog>
